<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>–ú–æ–∏ —Ç–µ—Å—Ç—ã</title>
    <link href="assets/css/style.css" rel="stylesheet">
    <style>
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–∞ */
        .accordion-section {
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
            background: #fff;
        }
        .accordion-header {
            background: #f8f9fa;
            padding: 18px 20px;
            cursor: pointer;
            font-size: 22px;
            font-weight: 600;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: background 0.3s;
        }
        .accordion-header:hover {
            background: #e9ecef;
        }
        .accordion-header::after {
            content: '‚ñº';
            margin-left: auto;
            font-size: 18px;
            transition: transform 0.3s;
        }
        .accordion-header.active::after {
            transform: rotate(180deg);
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease-out, padding 0.3s;
            padding: 0 20px;
            background: #fff;
        }
        .accordion-content.active {
            max-height: 2000px;
            padding: 20px;
        }
        .test-row {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        .test-card {
            flex: 1 1 45%;
            min-width: 300px;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 20px;
            background: #fafafa;
        }
        .test-card h4 {
            margin-top: 0;
            color: #34495e;
        }
        .empty-msg {
            color: #95a5a6;
            font-style: italic;
            padding: 20px;
            text-align: center;
        }
    </style>
</head>
<body class="page-sidebar-fixed page-header-fixed">
    <div class="page-container">
        <!-- Sidebar -->
        <div class="page-sidebar">
            <a class='logo-box' href="tests.html">
                <div>
                    <span style="color: white; font-size: 18px;">üéì –°–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</span>
                </div>
            </a>
            <div class="page-sidebar-inner">
                <div class="page-sidebar-menu">
                    <ul class="accordion-menu">
                        <li class="active">
                            <a href="tests.html">
                                <i class="menu-icon">üìö</i><span>–ú–æ–∏ —Ç–µ—Å—Ç—ã</span>
                            </a>
                        </li>
                        <li>
                            <a href="results.html">
                                <i class="menu-icon">üìä</i><span>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã</span>
                            </a>
                        </li>
                        <li>
                            <a href="#" onclick="logout()">
                                <i class="menu-icon">üö™</i><span>–í—ã–π—Ç–∏</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Content -->
        <div class="page-content">
            <div class="page-header">
                <nav class="navbar">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <a href="javascript:void(0)" id="sidebar-toggle-button" style="font-size: 24px; text-decoration: none;">‚ò∞</a>
                        </div>
                        <div class="dropdown">
                            <a href="#" class="dropdown-toggle">
                                üë§ <span id="userName"></span>
                                <span>‚ñº</span>
                            </a>
                            <ul class="dropdown-menu">
                                <li><a href="#" onclick="logout()">üö™ –í—ã–π—Ç–∏</a></li>
                            </ul>
                        </div>
                    </div>
                </nav>
            </div>

            <div class="page-inner">
                <div class="page-title">
                    <h1>–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–µ—Å—Ç—ã</h1>
                </div>
                <div id="sectionsContainer"></div>
            </div>
        </div>
    </div>

    <script src="data.js"></script>
    <script>
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        const currentUser = JSON.parse(localStorage.getItem('currentUser'));
        if (!currentUser) {
            window.location.href = 'index.html';
        }
        document.getElementById('userName').textContent = currentUser.fullName;

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ä–∞–∑–¥–µ–ª–æ–≤
        const container = document.getElementById('sectionsContainer');

        DB.sections.forEach(section => {
            const sectionBlock = document.createElement('div');
            sectionBlock.className = 'accordion-section';

            const header = document.createElement('div');
            header.className = 'accordion-header';
            header.innerHTML = `
                ${section.icon} ${section.title}
                <small style="margin-left: 15px; color: #7f8c8d; font-weight: normal;">
                    ${section.tests.length} —Ç–µ—Å—Ç–æ–≤
                </small>
            `;

            const content = document.createElement('div');
            content.className = 'accordion-content';

            if (section.tests.length === 0) {
                content.innerHTML = `<p class="empty-msg">–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –ø–æ–∫–∞ –Ω–µ—Ç —Ç–µ—Å—Ç–æ–≤</p>`;
            } else {
                const row = document.createElement('div');
                row.className = 'test-row';

                section.tests.forEach(test => {
                    const card = document.createElement('div');
                    card.className = 'test-card';
                    card.innerHTML = `
                        <h4>${test.title}</h4>
                        <p style="color: #7f8c8d; margin: 10px 0;">${test.description || '–¢–µ—Å—Ç –ø–æ —Ç–µ–º–µ —Ä–∞–∑–¥–µ–ª–∞'}</p>
                        <p><strong>–í–æ–ø—Ä–æ—Å–æ–≤:</strong> ${test.questionCount}</p>
                        <p><strong>–í—Ä–µ–º—è:</strong> ${test.duration} –º–∏–Ω—É—Ç</p>
                        <a href="test.html?id=${test.id}" class="btn btn-primary" style="margin-top: 15px; display: inline-block;">
                            ‚ñ∂ –ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç
                        </a>
                    `;
                    row.appendChild(card);
                });
                content.appendChild(row);
            }

            sectionBlock.appendChild(header);
            sectionBlock.appendChild(content);
            container.appendChild(sectionBlock);

            // –†–∞—Å–∫—Ä—ã—Ç–∏–µ/–∑–∞–∫—Ä—ã—Ç–∏–µ —Ä–∞–∑–¥–µ–ª–∞
            header.addEventListener('click', () => {
                const isActive = content.classList.contains('active');
                
                document.querySelectorAll('.accordion-content').forEach(c => {
                    c.classList.remove('active');
                    c.previousElementSibling.classList.remove('active');
                });

                content.classList.toggle('active', !isActive);
                header.classList.toggle('active', !isActive);
            });
        });

        function logout() {
            localStorage.removeItem('currentUser');
            window.location.href = 'index.html';
        }

        document.getElementById('sidebar-toggle-button').addEventListener('click', function() {
            document.querySelector('.page-sidebar').classList.toggle('open');
        });

        document.querySelector('.dropdown-toggle').addEventListener('click', function(e) {
            e.preventDefault();
            this.parentElement.classList.toggle('open');
        });

        document.addEventListener('click', function(e) {
            if (!e.target.closest('.dropdown')) {
                document.querySelectorAll('.dropdown').forEach(dd => dd.classList.remove('open'));
            }
        });
    </script>
</body>
</html>
